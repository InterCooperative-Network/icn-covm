[
  { "Emit": "Defining functions..." },
  { "Def": {
    "name": "add",
    "params": ["x", "y"],
    "body": [
      { "Load": "x" },
      { "Load": "y" },
      { "Add": null },
      { "Return": null }
    ]
  }},
  { "Def": {
    "name": "multiply_and_print",
    "params": ["x", "y"],
    "body": [
      { "Load": "x" },
      { "Emit": "First number:" },
      { "Load": "y" },
      { "Emit": "Second number:" },
      { "Load": "x" },
      { "Load": "y" },
      { "Mul": null },
      { "Emit": "Product:" },
      { "Return": null }
    ]
  }},
  { "Def": {
    "name": "countdown",
    "params": ["n"],
    "body": [
      { "Load": "n" },
      { "Push": 0.0 },
      { "Lt": null },
      {
        "If": {
          "then": [
            { "Push": 0.0 },
            { "Return": null }
          ],
          "else_": [
            { "Load": "n" },
            { "Emit": "Current value:" },
            { "Load": "n" },
            { "Push": 1.0 },
            { "Sub": null },
            { "Store": "n" },
            { "Load": "n" },
            { "Call": "countdown" },
            { "Return": null }
          ]
        }
      }
    ]
  }},
  { "Emit": "Testing add with 20 and 22:" },
  { "Push": 20.0 },
  { "Push": 22.0 },
  { "Call": "add" },
  { "Emit": "Testing multiply_and_print with 6 and 7:" },
  { "Push": 6.0 },
  { "Push": 7.0 },
  { "Call": "multiply_and_print" },
  { "Emit": "Starting countdown from 5:" },
  { "Push": 5.0 },
  { "Call": "countdown" },
  { "Emit": "Stack manipulation demo:" },
  { "Push": 1.0 },
  { "Push": 2.0 },
  { "Push": 3.0 },
  { "Dup": null },
  { "Swap": null },
  { "Over": null },
  { "DumpStack": null },
  { "Emit": "Debugging features demo:" },
  { "DumpFunctions": null },
  { "DumpStackWithLabels": {
    "labels": ["first", "second", "third", "duplicate", "swapped", "over"]
  }},
  { "Push": 42.0 },
  { "Store": "x" },
  { "Push": 24.0 },
  { "Store": "y" },
  { "DumpMemoryWithLabels": {
    "labels": {
      "x": "counter",
      "y": "result"
    }
  }},
  { "DebugBreak": {
    "message": "Testing debug break"
  }},
  { "Trace": {
    "enabled": true
  }},
  { "Push": 10.0 },
  { "Push": 20.0 },
  { "Add": null },
  { "Trace": {
    "enabled": false
  }},
  { "Emit": "Testing nested function calls with debugging:" },
  { "Def": {
    "name": "outer",
    "params": ["x"],
    "body": [
      { "Def": {
        "name": "inner",
        "params": ["y"],
        "body": [
          { "DumpCallStack": null },
          { "Return": null }
        ]
      }},
      { "Push": 42.0 },
      { "Call": "inner" },
      { "Return": null }
    ]
  }},
  { "Push": 24.0 },
  { "Call": "outer" }
]
